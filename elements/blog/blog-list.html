
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="blog-card.html">
<!-- <link rel="import" href="../../bower_components/core-scroll-header-panel/demos/sample-content.html"> -->

<polymer-element name="blog-list">
  <template>
    <style>
        :host{
          height: 100%
        }
        #container{
          overflow: auto;
        }
        .card{
          text-align: left;
          background: white;
          margin-bottom: 10px;
          margin-top: 10px;
          width:400px;
          min-height: 200px;
        }
        .view {
          background-color: #ccc;
        }
        .blog-card{
          background: #fff;
        }
    </style>
    <core-ajax
        id="ajax" auto
        url="https://api.myjson.com/bins/2yku7"
        handleAs="json"
        response="{{response}}"
        progress="{{progress}}"
        loading="{{loading}}"
        ></core-ajax>
    <section flex vertical layout>
    <core-animated-pages flex id="pages" selected="0" on-core-animated-pages-transition-end="{{transitionend}}" transitions="cross-fade-all hero-transition">

      <section vertical layout>
        <div id="container" horizontal flex wrap around-justified layout hero-p>
          <template repeat="{{blog, i in blogs}}">
            	<blog-card class="card" on-tap="{{selection}}" hero-id="blog-{{i}}" hero?="{{$.pages.selected === i + 1 || lastSelected === i + 1}}">
                  <img src="{{blog.owner.avatar_url}}" width="70" height="70">
                  <h2>{{blog.description}}</h2>
                  <p>{{blog.updated_at}}</p>
                  {{i}}{{lastSelected}}
        	    </blog-card>
          </template>
        </div>
      </section>

      <template repeat="{{blog, i in blogs}}">
          <section vertical layout>
            <div class="view" hero-id="blog-{{i}}" flex vertical center center-justified layout  hero?="{{$.pages.selected === i + 1 || $.pages.selected === 0}}"><core-icon-button icon="{{$.pages.selected != 0 ? 'arrow-back' : 'menu'}}" on-tap="{{back}}"></core-icon-button><span cross-fade>{{blog.description}}</span></div>
          </section>
      </template>

     </core-animated-pages>
     </section>

  </template>

  <script>
  	Polymer('blog-list', {
		  responseChanged: function(oldValue) {
		    this.blogs = this.response;
        console.log(this.blogs);
		  },
      selection: function(e){
        var k = e.target.templateInstance.model.i;
        this.$.pages.selected = k+1;
      },
      transitionend: function(){
        if (this.lastSelected) {
          this.lastSelected = null;
        }
      },
      back: function() {
        this.lastSelected = this.$.pages.selected;
        this.$.pages.selected = 0;
      }
      
	  });
  </script>

</polymer-element>